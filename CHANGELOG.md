# 更新日志 / Changelog

本文档记录 Air Canvas 项目的所有重要更改。

---

## [2.0.0] - 2024-12-26

### 🎉 重大更新：3D粒子特效系统

#### ✨ 新增功能

**3D粒子系统**
- 🌟 新增完整的3D粒子特效模式
- ❤️ 3D爱心模型 - 使用隐式方程体积拒绝采样
- ✨ 满天星海模型 - 星系团聚类，360°全景
- 🪐 3D土星模型 - 球体+双层光环

**粒子渲染技术**
- 📐 透视投影系统 - FOV=700，真实3D空间感
- 🎨 景深效果 - 远小近大，远暗近亮
- ✨ 多层辉光渲染 - 霓虹光感
- 🔄 平滑模型过渡 - 弹簧物理引擎

**交互控制**
- 👋 手掌开合控制缩放 - 1x到8x爆发式缩放
- 💨 自动呼吸效果 - 6%幅度，细微律动
- 🔄 多轴旋转系统 - 土星支持X/Y/Z三轴斜转
- 🖱️ 鼠标点击支持 - UI交互更友好

**UI优化**
- 🎨 右侧滑入式UI面板 - 半透明深色背景
- 🌈 6种预设颜色 - 红/粉/蓝/绿/黄/紫
- 📱 现代化扁平设计 - 圆角按钮，统一风格
- 💡 底部退出提示 - "Press '2' to Exit"

#### ⚡ 性能优化

**渲染优化**
- ❌ 取消Z-Buffer排序 - FPS提升40%
- ❌ 去除抗锯齿渲染 - FPS提升20%
- 💡 发光效果优化 - 仅1/3粒子发光，提升15%
- 📉 粒子数量优化 - 从15000降至5000

**响应速度优化**
- ⚡ 120Hz超高频更新 - 从60Hz提升2倍
- ⚡ 相机响应提升 - 0.1 → 0.2（2倍速）
- ⚡ 粒子平滑提升 - 0.12 → 0.18（50%）
- 🎯 非线性手势映射 - 小动作响应增强40%

**资源优化**
- 💾 内存占用 - 降至~40MB（-20%）
- 🔧 CPU占用 - 降至~12%（-20%）
- 📊 总延迟 - 控制在80ms以内
- ✅ 稳定60FPS - 无卡顿无掉帧

#### 🎨 视觉优化

**爱心模型优化**
- 💝 更圆润的爱心形状 - 调整隐式方程系数
- 🎯 外密内疏策略 - 轮廓清晰，内部通透
- 📐 外圈80%密度 - 显示清晰轮廓
- 🌫️ 内圈10%密度 - 稀疏透气有层次

**土星模型优化**
- 🪐 三轴旋转系统 - X/Y/Z轴协同旋转
- 🔄 斜着转动效果 - 完整展示球体和光环
- 💍 双层光环 - 主光环+外光环
- 🌍 球体+光环占比 - 40% + 50% + 10%

**星空模型优化**
- ⭐ 星系团聚类 - 40%粒子形成聚集
- 🌌 核心+外围分布 - 60%密集 + 40%稀疏
- 🎆 大范围分布 - 充满整个屏幕

**背景与显示**
- ⬛ 纯黑背景 - 突出粒子效果
- 📹 左下角摄像头 - 1/5大小，不遮挡
- 🎨 发光粒子效果 - 霓虹光感

#### 🔧 技术改进

**新增文件**
- `modules/particle_system_3d.py` - 3D粒子系统引擎
- `modules/particle_models_3d.py` - 3D粒子模型库
- `modules/particle_mode_ui.py` - 粒子模式UI面板

**算法实现**
- 📐 透视投影算法 - `perspective_projection()`
- 🔄 3D旋转变换 - `rotate_3d()`
- 🎯 隐式方程采样 - `volumetric_heart()`
- ⚙️ 弹簧物理引擎 - 平滑追踪与过渡

**配置参数**
- 🎛️ 粒子数量：5000
- 📏 FOV：700
- 📐 相机距离：3.0
- 💨 呼吸速度：0.4
- 💫 呼吸幅度：6%

---

## [1.5.0] - 2024-11-15

### 🔧 手势识别系统优化

#### 改进功能

**三指捏合检测**
- 🎯 优化捏合阈值 - PINCH_THRESHOLD = 0.12
- ⚡ 几乎零死区松开 - PINCH_RELEASE_THRESHOLD = 0.09
- 🖐️ 快速响应 - 手指轻微分开即停止绘画
- 📐 精确距离计算 - 三指中心点作为笔尖

**橡皮擦识别优化**
- ✋ 严格五指张开检测 - 避免误触发
- 📏 指尖距手腕距离检测 - 确保手掌完全张开
- 🎯 拇指食指分离检测 - 防止捏合姿势残留
- ❌ 排除两指+三指张开 - 防止画图时误触发

**手势UI界面**
- 🎨 两指竖起呼出UI - 食指+中指
- 🌈 颜色选择面板 - 10种预设颜色
- 📏 粗细调节 - 5档粗细可选
- 🖌️ 笔刷类型 - 实心/空心/霓虹
- 💡 悬停高亮效果 - 实时反馈

#### 技术细节

**配置优化**
```python
PINCH_THRESHOLD = 0.12           # 捏合触发
PINCH_RELEASE_THRESHOLD = 0.09   # 松开触发（几乎零死区）
```

**新增方法**
- `_is_palm_open()` - 严格手掌张开检测
- `_is_finger_extended()` - 手指伸展距离检测
- `_is_thumb_extended()` - 拇指伸展检测

---

## [1.2.0] - 2024-10-20

### 🎨 绘画功能增强

#### 新增功能

**形状识别与美化**
- 🔵 圆形识别 - 自动转换为规则圆
- ⬜ 矩形识别 - 自动转换为规则矩形
- 🔺 三角形识别 - 自动转换为规则三角形
- ⚡ 实时识别 - 绘制完成即美化

**笔刷系统**
- 🎨 实心圆笔刷 - 默认笔刷
- ⭕ 空心圆笔刷 - 轮廓效果
- ✨ 霓虹笔刷 - 发光效果

**画布功能**
- 💾 保存功能 - 导出为PNG图片
- 🗑️ 清空画布 - 一键清除
- 🖥️ 全屏模式 - 沉浸式绘画

#### 平滑算法

**EMA平滑**
- 📊 指数移动平均 - 消除手部抖动
- ⚙️ 平滑系数：0.3
- ⚡ 低延迟 - 实时响应

**One Euro Filter**
- 🎯 自适应滤波 - 备选方案
- 📐 多种预设 - DRAWING/PRECISION/CURSOR/LASER
- 🔄 动态调整 - 根据速度自适应

---

## [1.0.0] - 2024-10-01

### 🎉 初始版本发布

#### 核心功能

**手部检测**
- 👋 MediaPipe Hands集成
- 📍 21个手部关键点实时追踪
- 🎥 720p摄像头支持
- ⚡ 高性能检测引擎

**基础手势**
- ✍️ 三指捏合绘画
- 🖐️ 五指张开擦除
- 👆 食指指向控制
- ✊ 拳头暂停

**绘画系统**
- 🎨 基础画布
- ✏️ 虚拟画笔
- 🧽 橡皮擦
- 🎯 坐标映射

**AR效果**
- 🔴 激光笔指向
- 📊 掌心HUD显示
- 💫 粒子拖尾效果

#### 技术架构

**项目结构**
```
core/          # 核心检测与识别
modules/       # 功能模块
utils/         # 工具函数
config.py      # 配置文件
main.py        # 主程序
```

**依赖库**
- OpenCV 4.x
- MediaPipe
- NumPy
- PyAutoGUI

---

## 📊 版本对比

| 版本 | 主要特性 | 粒子数 | FPS | 内存 |
|------|---------|--------|-----|------|
| v2.0 | 3D粒子特效 | 5000 | 60 | 40MB |
| v1.5 | 手势优化 | 300 | 60 | 30MB |
| v1.2 | 形状识别 | 200 | 60 | 25MB |
| v1.0 | 基础绘画 | 100 | 45 | 20MB |

---

## 🎯 未来计划

### v2.1 (计划中)
- [ ] 更多粒子模型（银河系、DNA双螺旋）
- [ ] 粒子录制与回放
- [ ] VR/AR设备支持
- [ ] 多手协同交互

### v2.2 (规划中)
- [ ] 深度学习手势识别
- [ ] 自定义粒子模型
- [ ] 网络多人协作
- [ ] 移动端支持

---

## 🐛 已知问题

### v2.0
- 暂无已知严重问题

### v1.5
- ~~橡皮擦容易误触发~~ ✅ 已修复（v1.5.1）
- ~~三指松开不灵敏~~ ✅ 已修复（v1.5.2）

### v1.0
- ~~手部抖动严重~~ ✅ 已修复（v1.2）
- ~~形状不规则~~ ✅ 已修复（v1.2）

---

<div align="center">

**感谢使用 Air Canvas！** ⭐

[返回主页](README.md) | [提交问题](https://github.com/your-username/Air-Convas/issues) | [贡献代码](CONTRIBUTING.md)

</div>

